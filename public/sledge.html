<html>
	<head>
  	<title>Sledge Tester</title>	
  	<style>
    	.ad {
      	margin: 50px auto;
        display: table;
    	}
  	</style>
  	
    <script type='text/javascript'>    	
			(function(window, id, data) {	
  			var API = window[id] = window[id] || {};
        var base_url = (
          document.location.protocol + "//" + id.toLowerCase() + 
          "." + document.location.host.split(".").slice(-2).join(".") + "/"
        )
        
        API.cmd = API.cmd || [];
  			API.cmd.push(function() {
          data.init(API)
          
          data.slots.forEach(function(s) {
            API.defineSlot(s[0], s[1], s[2]).addService(API.pubads())
          })
        })
        
        function url_builder(url) {
          return [
            base_url, btoa(url), "?r=", 
            Math.random(), "&id=", id
          ].join("")
        }
        
        function tag_builder(url, name, path) {         
          var tag = document.createElement(name)
  	      tag[path] = url_builder(url)
          tag.async = !!data.async;
          return tag          
        }
        
        function script_cleaner(document, text) {            
            var scripts = '';
            var cleaned = text.replace(/<script(.*?)>([\s\S]*?)<\/script>/gi, function(){
                if(arguments[1].indexOf("src") > -1)
                  return arguments[0]
                
                scripts += arguments[2] + ';\n';
                return '';
            });
      
            var script = document.createElement('script');
            script.setAttribute('type', 'text/javascript');
            script.innerText = scripts;
            return [cleaned, script];
        }

        
        function tag_inserted(event, ele) {        
          ele = ele || event.target
          var src = ele.src || ele.href
          var tagName = (ele.tagName || "").toLowerCase()
          
          if (!!src && src.indexOf(base_url) == -1 && src.indexOf("javascript:") == -1) {
            var path = ele.src ? "src" : "href"
            var node = tag_builder(src, tagName, path)
            var node = (tagName == "script") ? tag_builder(src, tagName, path) : ele.cloneNode(true)
            node[path] = url_builder(src)
            ele.parentNode.replaceChild(node, ele)
            console.log(src, node)
          }
          
          if(tagName == "iframe") { 
            if(ele.contentDocument == null) return
            
            ele.contentDocument.script_cleaner = script_cleaner
            ele.contentDocument.addEventListener('DOMNodeInserted', tag_inserted)
            ele.write = ele.contentDocument.write = function(content) {
              var out = this.script_cleaner(this, content)
              this.body.innerHTML += out[0]
              this.getElementsByTagName('head')[0].appendChild(out[1])
            }
          }
          
          ele.childNodes.forEach(function(node) {          
            return tag_inserted(null, node)
          })
        }
  			
        document.addEventListener('DOMNodeInserted', tag_inserted)
        var script = tag_builder("www.googletagservices.com/tag/js/gpt.js", "script", "src")
        script.type = "text/javascript"
        document.getElementsByTagName('head')[0].appendChild(script)
			})(window, "Em1nqJ7AsZ", {
  		  async: true,
  		  init: function(API) {
    		  API.pubads().enableSingleRequest()
    		  API.enableServices()
  		  },
  		  slots: [
    		  ['/72625737/sledge', [300, 250], 'Em1nqJ7AsZ-1468566910229-0']
  		  ]
			})
		</script>
	</head>
	<body>
  	<div class="ad">
      <div id='Em1nqJ7AsZ-1468566910229-0'>
        <script type='text/javascript'>
          Em1nqJ7AsZ.cmd.push(function() { 
            Em1nqJ7AsZ.display('Em1nqJ7AsZ-1468566910229-0'); 
          });
        </script>
      </div>
  	</div>
	</body>
</html>